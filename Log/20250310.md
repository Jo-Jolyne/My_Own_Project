**2025.03.10记录**

**今天主要学习了数据大小端格式的转换以及负数的相关知识**



**主要学习内容:1.16位和32位数据的大小端格式转换;2.C语言负数表示的学习**

**1.16位和32位数据的大小端格式转换**

**1.1一个简单的例子:**

```c
#include <stdio.h>
#include <stdint.h>

//2个字节数据的大小端转换
#define Swap_u16_Endian(A) ((((uint16_t)(A) & 0xff00) >> 8 ) | (((uint16_t)(A) & 0x00ff) << 8 ))
//4个字节数据的大小端转换
#define Swap_u32_Endian(B) ((((uint32_t)(B) & 0xff000000) >> 24) | \
                            (((uint32_t)(B) & 0x00ff0000) >>  8) | \
                            (((uint32_t)(B) & 0x0000ff00) <<  8) | \
                            (((uint32_t)(B) & 0x000000ff) << 24))
//int16_t和int32_t的转换方法和u16,u32一样,只需要修改数据类型即可

int main()
{
    printf("Swap_u16_Endian(0x1234) = %#x\n",Swap_u16_Endian(0x1234));//16位数据0x1234大端转小端
    printf("Swap_u16_Endian(0x3412) = %#x\n",Swap_u16_Endian(0x3412));//16位数据0x1234小端转大端
    printf("Swap_u32_Endian(0x12345678) = %#x\n",Swap_u32_Endian(0x12345678));//32位数据0x12345678小端转大端
    printf("Swap_u32_Endian(0x78563412) = %#x\n",Swap_u32_Endian(0x78563412);//32位数据0x78563412小端转大端
    return 0;
}

```

**运行效果:**

```c
Swap_u16_Endian(0x1234) = 0x3412
Swap_u16_Endian(0x3412) = 0x1234
Swap_u32_Endian(0x12345678) = 0x78563412
Swap_u32_Endian(0x78563412) = 0x12345678
```

![](https://github.com/Jo-Jolyne/My_Own_Project/blob/main/Pictures/20250310_DataEndian.png)



**2.C语言负数表示的学习**

**2.1一个简单的例子:**

```c
#include <stdio.h>
#include <stdint.h>

int main() 
{
    int8_t  data1 = 0xFF;
    uint32_t data2 = 0xFFFFFFFF;
    printf("data1 = %d\n", data1);  //打印data1
    printf("data2 = %d\n", data2);  //打印data2
    return 0;
}
```

**运行效果:**

```c
data1 = -1
data2 = -1
```

![](https://github.com/Jo-Jolyne/My_Own_Project/blob/main/Pictures/20250310_Minus.png)

**2.2代码解析:**

**2.2.1`int8_t  data1 = 0xFF;`**

- **data1**的类型是 **`int8_t`**,它是一个 8 位的有符号整数(**`signed char`**);

- **0xFF** 作为 **`int8_t`** 类型时,它表示的是 **负数**.对于8位有符号数,**0xFF** 代表的补码值是 **-1**;

  - 在C语言中,负数的表示是通过补码来实现的;

  - 原码,补码,反码的相关知识:

    原码:**一个**正数**按照绝对值大小转换成的二进制数;一个**负数**按照绝对值大小转换成的二进制数,然后最高位由原来的0改为1.

    ​	比如:**5**的原码为**0000 0000 0000 0000 0000 0000 0000 0101**,

    ​		**-5**的原码为**1000 0000 0000 0000 0000 0000 0000 0101**

    反码:**一个**正数**的反码与原码相同,一个**负数**的反码就是在其**原码**的基础上,符号位(最高位)不变,其余位取反.

    ​	比如:**5**的反码为**0000 0000 0000 0000 0000 0000 0000 0101**,

    ​		**-5**的反码为**1111 1111 1111 1111 1111 1111 1111 1010**

    补码:**一个**正数**的补码与原码相同,一个**负数**的补码就是在其**反码**的基础上,在**最后一位**加1.

    ​	比如:**5**的补码为**0000 0000 0000 0000 0000 0000 0000 0101**,

    ​		**-5**的补码为**1111 1111 1111 1111 1111 1111 1111 1011**

- 8位有符号数(**`signed char`**)的范围是 **-128** 到 **127**.**0xFF** (即二进制 **1111 1111**) 作为补码表示的是 **-1**
- 然而在**`printf`**函数中,使用 **`%d`** 打印时,期望的是 **`int`** 类型.因此,**`int8_t`** 会被提升为 **`int`**(32 位).这时,**`data1`**的值仍然是**-1**,只是类型提升了

**2.2.2`uint32_t data2 = 0xFFFFFFFF;`**

- **data2**的类型是 **`uint32_t`**,它是一个32位的无符号整数(**`unsigned`**);

- **-1的原码:**1000 0000 0000 0000 0000 0000 0000 0001;

  **-1的反码:**1111  1111 1111  1111  1111  1111  1111 1110;

  **-1的补码:**1111  1111 1111  1111  1111  1111  1111 1111;

  **所以对于32位数据来说,-1的补码就是0xFFFFFFFF**

- 然而,在`printf`函数中,使用`%d`打印时,`uint32_t`类型会被提升为`int`,即`data2`会被解释为有符号`int`(通常是32位)类型的数据.此时,**4294967295**这个值会被转换为一个负数.
  - 由于数据类型`int`的范围是**-2147483648**到**2147483647**,**4294967295**超出了这个范围,因此它会发生**溢出**.实际上,**4294967295** 在 **`int`**中表示的是**-1**(这是因为**4294967295**对应的补码表示为 **0xFFFFFFFF**,在32位带符号整数中表示的是**-1**).

**总结:**`data1`和`data2`的值虽然原本是不同的(`data1`是**-1**,`data2`是**4294967295**),但由于打印时使用了`%d`格式符,这两个变量的类型都会被转换为`int`(32位),并且在`int`类型的范围内,两者都被解释为-1.所以打印出来的结果是一样的:**-1**.

**2.3补充:常见数据类型的数据范围**

| 数据类型                        | 占内存字节数 | 表示范围                     |
| :------------------------------ | ------------ | ---------------------------- |
| **char(signed char)**           | 1            | **-128 ~ 127**               |
| **unsigned char**               | 1            | **0 ~ 255**                  |
| **short int(signed short int)** | 2            | **-32768 ~ 32767**           |
| **unsigned short int**          | 2            | **0 ~ 65535**                |
| **int(signed int)**             | 4            | **-2147483648 ~ 2147483647** |
| **unsigned int**                | 4            | **0 ~ 4294967295**           |



